(()=>{"use strict";class e{constructor(e){this.parent=e,this.element=null,this.data=null,this._isHidden=!1}setElement(e){this.element=e}hide(){this.element.classList.remove("show"),this.element.classList.add("hide"),this._isHidden=!0}show(){this.element.classList.remove("hide"),this.element.classList.add("show"),this._isHidden=!1}isHidden(){return this._isHidden}on(e,t){this.element.addEventListener(e,t)}activate(){this.element.classList.add("active")}deActivate(){this.element.classList.remove("active")}focus(){this.element.focus(),this.element.scrollIntoView()}destroy(){this.parent=null,this.element=null,this.data=null}}class t extends e{constructor(e){super(e)}getWidth(){return 4}}class s extends t{constructor(e){super(e),this.element=e.element.querySelector(".vertical-bar.to-previous")}}class i extends t{constructor(e){super(e),this.element=e.element.querySelector(".vertical-bar.to-next")}}class r extends e{constructor(e){super(e),this.element=e.element.querySelector(".horizontal-bar")}place(e,t){this.element.style.left=e+"px",this.element.style.width=t+"px"}}class n extends e{static tabIndex=1;constructor(e){super(e),this.element=e.element.querySelector(".explanation"),this.element.tabIndex=n.tabIndex,n.tabIndex++}}class h extends e{constructor(e){super(e),this.element=e.element.querySelector(".preview")}}class l extends e{constructor(e){super(e)}}class o extends l{constructor(e){super(e),this.element=e.element.querySelector(".add-next-step"),this.element.addEventListener("click",(e=>{this.parent.addNextStep()}))}}class a extends l{constructor(e){super(e),this.element=e.element.querySelector(".show-next-steps"),this.element.addEventListener("click",(e=>{this.parent.showNextSteps()}))}}class d extends l{constructor(e){super(e),this.element=e.element.querySelector(".hide-next-steps"),this.element.addEventListener("click",(e=>{this.parent.hideNextSteps()}))}}class c extends l{constructor(e){super(e),this.element=e.element.querySelector(".remove-self"),this.element.addEventListener("click",(e=>{const t=this.parent;t.parent?confirm("Removing this will remove all next steps also. You can not get them back. Are you sure?")&&t.parent.removeNextStep(e):alert("cannot remove this")}))}}class p extends e{constructor(e){super(e),this.element=e.element.querySelector(".step-toolbar"),this.addNextStep=new o(e),this.showNextSteps=new a(e),this.hideNextSteps=new d(e),this.removeSelf=new c(e)}destroy(){this.addNextStep.destroy(),this.showNextSteps.destroy(),this.hideNextSteps.destroy(),this.removeSelf.destroy(),super.destroy()}}class u extends e{constructor(e){super(e),this.element=e.element.querySelector(".visual"),this.preview=new h(e),this.stepToolbar=new p(e)}destroy(){this.preview.destroy(),this.stepToolbar.destroy(),super.destroy()}}class m extends e{constructor(e){super(e),this.element=e.element.querySelector(".next-steps"),this.userSteps=[]}getUserStepIndex(e){let t=e.closest(".step");for(let e=0;e<this.userSteps.length;e++)if(this.userSteps[e].element===t)return e;return-1}getUserStepWidth(e){return this.userSteps[e].width}getFirstStepWidth(){return 0===this.userSteps.length?0:this.userSteps[0].width}getLastStepWidth(){return 0===this.userSteps.length?0:this.userSteps[this.userSteps.length-1].width}getCount(){return this.userSteps.length}getWidth(){let e=0;return this.userSteps.forEach(((t,s)=>{e+=t.width})),e}add(e){this.element.appendChild(e.element),this.userSteps.push(e)}remove(e){this.userSteps[e].destroy(),this.userSteps.splice(e,1)}destroy(){this.userSteps=[],super.destroy()}}class x extends e{static template=document.getElementById("user-step").content.firstElementChild;static paddingX=4;static initialWidth=208;constructor(e){super(e);const t=x.template.cloneNode(!0);this.element=t,this.verticalBarToParent=new s(this),this.explanation=new n(this),this.visual=new u(this),this.verticalbarToNext=new i(this),this.horizontalBar=new r(this),this.nextSteps=new m(this),this.width=x.initialWidth}setParent(e){throw"not implemented"}createIn(e){const t=document.querySelector(e);t&&t.appendChild(this.element)}addNextStep(){const e=new x(this);this.nextSteps.add(e),this.showNextSteps(),this.verticalbarToNext.show(),this.horizontalBar.show(),e.verticalBarToParent.show(),this.resize(),this.explanation.focus()}showNextSteps(){this.nextSteps.show(),this.verticalbarToNext.show(),this.horizontalBar.show(),this.resize(),this.visual.stepToolbar.showNextSteps.deActivate(),this.visual.stepToolbar.hideNextSteps.activate()}hideNextSteps(){this.nextSteps.hide(),this.verticalbarToNext.hide(),this.horizontalBar.hide(),this.resize(),this.visual.stepToolbar.showNextSteps.activate(),this.visual.stepToolbar.hideNextSteps.deActivate()}removeNextStep(e){let t=e.target,s=this.nextSteps.getUserStepIndex(t);-1!==s&&(this.nextSteps.remove(s),this.resize())}resize(){const e=this.nextSteps.getWidth(),t=this.nextSteps.getCount();if(this.width=e,0===t||this.nextSteps.isHidden())this.width=x.initialWidth,this.horizontalBar.place(0,0),this.verticalbarToNext.hide(),this.horizontalBar.hide();else{const t=this.nextSteps.getFirstStepWidth(),s=this.nextSteps.getLastStepWidth(),i=this.verticalBarToParent.getWidth(),r=e-t/2-s/2+i,n=t/2-i/2-x.paddingX;this.horizontalBar.place(n,r)}this.parent&&this.parent.resize()}destroy(){this.verticalBarToParent.destroy(),this.explanation.destroy(),this.visual.destroy(),this.verticalbarToNext.destroy(),this.horizontalBar.destroy(),this.nextSteps.destroy(),this.element.remove(),super.destroy()}}window.addEventListener("DOMContentLoaded",(e=>{S.init()}));var S=function(){let e=!1,t=null,s=null;return{init:function(){e||(s=document.getElementById("main"),t=new x(null),t.createIn("#main"),console.log("initialized"),e=!0)}}}()})();